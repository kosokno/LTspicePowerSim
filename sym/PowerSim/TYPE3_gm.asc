Version 4.1
SHEET 1 2344 1140
WIRE 512 -208 512 -224
WIRE 624 -208 624 -224
WIRE 512 -112 512 -128
WIRE 624 -112 624 -128
WIRE -384 112 -416 112
WIRE -224 112 -224 80
WIRE 480 112 480 80
WIRE 880 160 880 144
WIRE -384 192 -416 192
WIRE -224 240 -224 192
WIRE -224 240 -336 240
WIRE -96 240 -224 240
WIRE 352 240 -96 240
WIRE 480 240 480 192
WIRE 592 240 480 240
WIRE 720 240 592 240
WIRE 880 240 880 224
WIRE 880 240 720 240
WIRE 1008 240 880 240
WIRE 880 256 880 240
WIRE -224 272 -224 240
WIRE 592 272 592 240
WIRE -336 304 -336 240
WIRE -96 304 -96 240
WIRE 720 304 720 240
WIRE 880 336 880 320
WIRE 592 368 592 352
WIRE -224 384 -224 352
WIRE -336 464 -336 384
WIRE -224 464 -224 448
WIRE -96 464 -96 368
WIRE 592 464 592 448
WIRE 720 464 720 384
FLAG 624 -112 0
FLAG 512 -112 0
FLAG 512 -224 +V
FLAG 624 -224 -V
FLAG -224 464 0
FLAG -224 80 0
FLAG -336 464 0
FLAG -96 464 0
FLAG 592 464 0
FLAG 720 464 0
FLAG 480 80 0
FLAG 352 240 a
FLAG 880 336 -V
FLAG 880 144 +V
FLAG 1008 240 ve
IOPIN 1008 240 Out
FLAG -416 112 fb
IOPIN -416 112 In
FLAG -416 192 ref
IOPIN -416 192 In
SYMBOL voltage 512 -224 R0
SYMATTR InstName V1
SYMATTR Value {vh}
SYMBOL voltage 624 -224 R0
SYMATTR InstName V2
SYMATTR Value {vl}
SYMBOL bi -224 112 R0
SYMATTR InstName B2
SYMATTR Value I=(V(ref)-V(fb))
SYMBOL res -240 256 R0
SYMATTR InstName R4
SYMATTR Value {Rz1}
SYMBOL cap -240 384 R0
SYMATTR InstName C4
SYMATTR Value {Cz1}
SYMBOL res -352 288 R0
SYMATTR InstName R5
SYMATTR Value {avol}
SYMBOL cap -112 304 R0
SYMATTR InstName C5
SYMATTR Value {Co1}
SYMBOL res 576 256 R0
SYMATTR InstName R6
SYMATTR Value {Rz2}
SYMBOL res 704 288 R0
SYMATTR InstName R7
SYMATTR Value {Ro2}
SYMBOL ind 576 352 R0
SYMATTR InstName L1
SYMATTR Value {Lz2}
SYMBOL bi 480 112 R0
SYMATTR InstName B3
SYMATTR Value I=(limit(V(a),{-Ilim},{Ilim}))
SYMBOL diode 896 224 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value myD
SYMBOL diode 896 320 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMATTR Value myD
TEXT -224 -288 Left 2 !.param g=1\n.param fz1=1k\n.param fz2=5k\n.param fp1=30k\n.param fp2=100k\n.param vh=5\n.param vl=0\n.param avol=100k
TEXT -264 -368 Left 4 ;Type 3 Compensator, Gm amp base
TEXT 24 -288 Left 2 ;target gain at fz1\n1st zero frequency(Hz)\n2nd zero frequency(Hz)\n1st pole frequency(Hz)\n2nd pole frequency(Hz)\nmax ouput voltage(V)\nmin output voltage(V)\nopen loop gain
TEXT 976 -416 Left 2 ;2025-08-31
TEXT -120 24 Left 2 !.param Rz1={(g*avol)/(avol-g)}\n.param Cz1={1/(2*PI*fz1*Rz1)}\n.param Co1={1/(2*PI*fp1*Rz1)}
TEXT 592 24 Left 2 !.param Rz2=1\n.param Lz2={Rz2/(2*PI*fz2)}\n.param Ro2={2*PI*fp2*Lz2}
TEXT 856 400 Left 2 !.MODEL myD D(RON=1u ROFF=1G Vfwd=10n)
TEXT -136 144 Left 2 !.param Ilim=1000
TEXT 752 -240 Left 2 ;<Revision History>\n2025-08-31: Initial version
TEXT -464 80 Left 2 ;feedback
TEXT -464 152 Left 2 ;reference
TEXT 512 -368 Left 1 ;* TYPE2_gm is a Gm-amp based version of TYPE2.\n* Unlike the op-amp based TYPE2, it offers high input impedance at ref/fb\n* and is better suited for dynamic reference applications (e.g. soft-start,\n* motor speed control). Both models are kept for flexibility.
RECTANGLE Normal 1120 -288 496 -384 2
