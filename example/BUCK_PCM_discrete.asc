Version 4
SHEET 1 1464 1312
WIRE 992 176 752 176
WIRE 1040 176 992 176
WIRE 752 208 752 176
WIRE -240 256 -272 256
WIRE -112 256 -144 256
WIRE -80 256 -112 256
WIRE 32 256 16 256
WIRE 1040 256 1040 176
WIRE -240 320 -272 320
WIRE -112 320 -144 320
WIRE -80 320 -112 320
WIRE 32 320 16 320
WIRE 752 320 752 288
WIRE 992 336 960 336
WIRE -272 352 -272 320
WIRE -112 352 -112 320
WIRE 32 352 32 320
WIRE 864 352 832 352
WIRE 1040 368 1040 352
WIRE 1040 368 960 368
WIRE 1248 368 1248 352
WIRE 1040 400 1040 368
WIRE 1072 400 1040 400
WIRE 1120 400 1072 400
WIRE 1216 400 1200 400
WIRE 1296 400 1280 400
WIRE 1376 400 1296 400
WIRE 1392 400 1376 400
WIRE 832 432 832 352
WIRE 832 432 784 432
WIRE 1040 432 1040 400
WIRE 352 448 320 448
WIRE 464 448 416 448
WIRE 480 448 464 448
WIRE 624 448 560 448
WIRE 688 448 624 448
WIRE 1296 448 1296 400
WIRE 1392 448 1392 400
WIRE 832 464 784 464
WIRE -592 480 -624 480
WIRE -496 480 -528 480
WIRE -448 480 -496 480
WIRE 464 480 448 480
WIRE 480 480 464 480
WIRE 992 512 960 512
WIRE 832 528 832 464
WIRE 864 528 832 528
WIRE -448 544 -448 480
WIRE 1040 544 1040 528
WIRE 1040 544 960 544
WIRE -496 576 -528 576
WIRE -480 576 -496 576
WIRE -400 576 -416 576
WIRE -304 576 -336 576
WIRE -224 576 -240 576
WIRE -80 576 -160 576
WIRE 192 592 144 592
WIRE 320 592 256 592
WIRE 352 592 320 592
WIRE 1040 592 1040 544
WIRE 1296 592 1296 512
WIRE 1392 592 1392 528
WIRE -80 608 -112 608
WIRE 448 608 448 480
WIRE 448 608 432 608
WIRE 352 624 304 624
WIRE -528 640 -528 576
WIRE -528 640 -576 640
WIRE -512 752 -576 752
WIRE -272 752 -272 608
WIRE -272 752 -352 752
WIRE -176 752 -272 752
WIRE -112 752 -112 608
WIRE -112 752 -176 752
WIRE 208 768 192 768
WIRE 304 768 304 624
WIRE 304 768 272 768
WIRE -512 784 -528 784
WIRE -336 784 -352 784
WIRE -528 864 -528 784
WIRE -528 864 -576 864
WIRE -144 880 -240 880
WIRE 80 880 -80 880
WIRE 240 880 240 800
WIRE 240 880 144 880
FLAG 1040 592 0
FLAG 752 320 0
FLAG 1296 592 0
FLAG 1376 400 out
FLAG 992 176 in
FLAG 1072 400 sw
FLAG 320 592 vc
FLAG 1392 592 0
FLAG 624 448 pwm
FLAG 1248 352 IL
FLAG 192 768 IL
FLAG 464 448 s
FLAG 464 480 r
FLAG -240 880 pwm
FLAG 240 880 slope
FLAG -624 480 out
FLAG -112 256 vc
FLAG -112 352 0
FLAG 32 352 0
FLAG 32 256 out
FLAG -496 576 ref
FLAG -496 480 fb
FLAG -272 256 fb
FLAG -336 784 pwmclk
FLAG 320 448 pwmclk
FLAG -272 352 0
FLAG -176 752 ctrlclk
SYMBOL voltage 752 192 R0
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 5
SYMBOL ind 1104 416 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 10u
SYMBOL cap 1280 448 R0
SYMATTR InstName C1
SYMATTR Value 22u
SYMATTR SpiceLine Rser=1m
SYMBOL iGD 912 352 R0
SYMATTR InstName X2
SYMBOL iGD 912 528 R0
SYMATTR InstName X3
SYMBOL DEADTIME 736 448 R0
SYMATTR InstName X1
SYMBOL res 1376 432 R0
SYMATTR InstName R1
SYMATTR Value 1
SYMBOL IMON 1248 400 M180
SYMATTR InstName X4
SYMBOL POSEDGE 384 448 R0
WINDOW 39 5 51 Bottom 2
SYMATTR SpiceLine TD=10n
SYMATTR InstName X7
SYMBOL CONST -608 752 R0
WINDOW 39 0 51 Bottom 2
SYMATTR SpiceLine K=1Meg
SYMATTR InstName X8
SYMBOL CMP 400 608 R0
SYMATTR InstName X9
SYMBOL SRFF 512 464 R0
SYMATTR InstName X11
SYMBOL SLOPE -112 880 R0
WINDOW 39 4 67 Bottom 2
SYMATTR SpiceLine Se={((5-1)/10u)*0.1}
SYMATTR InstName X12
SYMBOL CONST -608 640 R0
WINDOW 39 0 51 Bottom 2
SYMATTR InstName X14
SYMBOL fra -528 480 R270
WINDOW 0 16 -32 VTop 2
SYMATTR InstName @1
SYMATTR SpiceLine delay=1m fstart=1k fend=100k oct=2 nmax=2 pp0=2m pp1=2m f0=1k f1=10k tavgmin=100µ tsettle=1m
SYMBOL fraprobe -192 336 R0
SYMATTR InstName &1comp
SYMBOL fraprobe -32 336 R0
SYMATTR InstName &1plant
SYMBOL SUM 240 768 R0
SYMATTR InstName X5
SYMBOL iNMOS 1040 304 R0
SYMATTR InstName X10
SYMBOL iNMOS 1040 480 R0
SYMATTR InstName X15
SYMBOL PowerSim\\SUB -448 576 M180
SYMATTR InstName X16
SYMBOL PowerSim\\LPF -368 576 R0
WINDOW 3 0 56 Bottom 2
WINDOW 123 -1 81 Bottom 2
SYMATTR Value f=200k
SYMATTR InstName X17
SYMBOL PowerSim\\zPI 32 592 R0
WINDOW 39 -8 68 Bottom 2
WINDOW 3 -12 95 Bottom 2
WINDOW 123 -14 123 Bottom 2
SYMATTR SpiceLine g=6 fz1=5k
SYMATTR InstName X18
SYMBOL PowerSim\\SAMPLEHOLD -272 576 R0
SYMATTR InstName X19
SYMBOL PowerSim\\QUANTIZE -192 576 R0
WINDOW 3 -4 69 Bottom 2
WINDOW 123 -10 97 Bottom 2
SYMATTR Value vh=1 vl=-1
SYMATTR Value2 bits=14
SYMATTR InstName X20
SYMBOL PowerSim\\QUANTIZE 224 592 R0
WINDOW 3 2 59 Bottom 2
WINDOW 123 3 90 Bottom 2
SYMATTR Value vh=5 vl=0
SYMATTR InstName X13
SYMBOL PowerSim\\PHASESHIFT2 -432 768 R0
SYMATTR InstName X6
SYMBOL CONST -608 864 R0
WINDOW 39 0 51 Bottom 2
SYMATTR SpiceLine K=30
SYMATTR InstName X22
SYMBOL PowerSim\\QUANTIZE 112 880 R0
WINDOW 3 3 61 Bottom 2
WINDOW 123 3 90 Bottom 2
SYMATTR Value vh=5 vl=0
SYMATTR InstName X21
TEXT 224 128 Left 2 !.tran 0 0.3m 0.29m
TEXT -688 32 Left 6 ;Discrete Peak Current Mode Control Buck
TEXT 224 160 Left 2 ;.fra
TEXT 1200 48 Left 2 ;2025-3-23
TEXT -648 136 Left 2 ;Vin=5V, Vout=1V/1A
TEXT -256 496 Left 2 ;A/D
TEXT -40 496 Left 2 ;discrete PI
TEXT 200 496 Left 2 ;D/A
TEXT 88 800 Left 2 ;D/A
RECTANGLE Normal -128 688 -320 512 2
RECTANGLE Normal 160 720 -96 512 2
RECTANGLE Normal 288 704 160 512 2
RECTANGLE Normal 176 976 48 816 2
