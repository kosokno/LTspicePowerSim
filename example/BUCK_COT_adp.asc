Version 4
SHEET 1 1688 1668
WIRE 1008 176 848 176
WIRE 1056 176 1008 176
WIRE 848 192 848 176
WIRE 1056 256 1056 176
WIRE 848 288 848 272
WIRE 1008 336 976 336
WIRE 880 352 848 352
WIRE 1056 368 1056 352
WIRE 1056 368 976 368
WIRE 1264 368 1264 352
WIRE 1056 400 1056 368
WIRE 1088 400 1056 400
WIRE 1136 400 1088 400
WIRE 1232 400 1216 400
WIRE 1312 400 1296 400
WIRE 1392 400 1312 400
WIRE 1408 400 1392 400
WIRE 848 432 848 352
WIRE 848 432 800 432
WIRE 1056 432 1056 400
WIRE -320 448 -352 448
WIRE -224 448 -256 448
WIRE -192 448 -224 448
WIRE 640 448 608 448
WIRE 704 448 640 448
WIRE 1312 448 1312 400
WIRE 1408 448 1408 400
WIRE 64 464 32 464
WIRE 160 464 64 464
WIRE 848 464 800 464
WIRE -256 480 -304 480
WIRE -192 480 -256 480
WIRE 272 480 240 480
WIRE 304 480 272 480
WIRE 448 480 368 480
WIRE 560 480 528 480
WIRE 160 496 128 496
WIRE 448 512 416 512
WIRE 608 512 608 448
WIRE 608 512 528 512
WIRE 1008 512 976 512
WIRE 128 528 128 496
WIRE 128 528 96 528
WIRE 848 528 848 464
WIRE 880 528 848 528
WIRE -304 544 -304 480
WIRE -304 544 -336 544
WIRE 1056 544 1056 528
WIRE 1056 544 976 544
WIRE 1056 592 1056 544
WIRE 1312 592 1312 512
WIRE 1408 592 1408 528
WIRE 560 624 560 480
WIRE 592 624 560 624
WIRE 720 624 656 624
WIRE 832 640 800 640
WIRE 720 656 688 656
WIRE -224 672 -224 448
WIRE -176 672 -224 672
WIRE -48 672 -80 672
WIRE -16 672 -48 672
WIRE 96 672 80 672
WIRE 688 704 688 656
WIRE 688 704 656 704
WIRE -256 736 -256 480
WIRE -176 736 -256 736
WIRE -48 736 -80 736
WIRE -16 736 -48 736
WIRE 96 736 80 736
WIRE -48 768 -48 736
WIRE 96 768 96 736
WIRE 416 784 416 512
WIRE 448 784 416 784
WIRE 832 784 832 640
WIRE 832 784 512 784
WIRE 592 816 512 816
WIRE 272 864 272 480
WIRE 384 864 272 864
WIRE 592 864 592 816
WIRE 592 864 448 864
WIRE 608 1072 560 1072
WIRE 640 1072 608 1072
WIRE 640 1088 640 1072
WIRE 272 1104 128 1104
WIRE 128 1168 128 1104
WIRE 160 1168 128 1168
WIRE 304 1168 240 1168
WIRE 640 1184 640 1168
WIRE 720 1184 640 1184
WIRE -96 1200 -128 1200
WIRE 48 1200 0 1200
WIRE 160 1200 48 1200
WIRE 272 1200 272 1104
WIRE 272 1200 240 1200
WIRE 640 1200 640 1184
WIRE 720 1200 720 1184
WIRE 560 1232 528 1232
WIRE 624 1232 560 1232
WIRE 304 1280 304 1168
WIRE 352 1280 304 1280
WIRE 528 1280 528 1232
WIRE 528 1280 480 1280
WIRE 640 1296 640 1264
WIRE 720 1296 720 1264
WIRE 720 1296 640 1296
WIRE 832 1296 720 1296
WIRE 928 1296 832 1296
WIRE 1056 1296 928 1296
WIRE 1120 1296 1056 1296
WIRE 1248 1296 1184 1296
WIRE 352 1312 304 1312
WIRE 528 1312 480 1312
WIRE 272 1328 144 1328
WIRE 640 1328 640 1296
WIRE 720 1328 720 1296
WIRE 928 1328 928 1296
WIRE 528 1360 528 1312
WIRE 576 1360 528 1360
WIRE 624 1360 576 1360
WIRE 832 1360 832 1296
WIRE 144 1392 144 1328
WIRE 160 1392 144 1392
WIRE 304 1392 304 1312
WIRE 304 1392 240 1392
WIRE 640 1408 640 1392
WIRE 720 1408 720 1392
WIRE 720 1408 640 1408
WIRE 160 1424 48 1424
WIRE 272 1424 272 1328
WIRE 272 1424 240 1424
WIRE 640 1424 640 1408
WIRE 928 1424 928 1408
WIRE 640 1520 640 1504
WIRE 832 1520 832 1424
WIRE 928 1520 928 1488
FLAG 1056 592 0
FLAG 848 288 0
FLAG 1312 592 0
FLAG 1392 400 out
FLAG 1008 176 in
FLAG 1088 400 sw
FLAG 64 464 vc
FLAG 1408 592 0
FLAG 640 448 pwm
FLAG 1264 352 IL
FLAG 96 528 IL
FLAG -352 448 out
FLAG -48 672 vc
FLAG -48 768 0
FLAG 96 768 0
FLAG 96 672 out
FLAG 48 1424 pwm
FLAG 832 1520 0
FLAG 640 1520 0
FLAG 560 1232 up
FLAG 576 1360 down
FLAG 928 1520 0
FLAG 608 1072 fmax
FLAG 656 704 Toff
FLAG 1248 1296 Toff
FLAG 48 1200 ref
FLAG 1056 1296 invToff
SYMBOL voltage 848 176 R0
WINDOW 0 -52 6 Top 2
WINDOW 3 -54 87 Bottom 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value {Vin}
SYMBOL ind 1120 416 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 10u
SYMBOL cap 1296 448 R0
SYMATTR InstName C1
SYMATTR Value 22u
SYMATTR SpiceLine Rser=1m
SYMBOL iGD 928 352 R0
SYMATTR InstName X2
SYMBOL iGD 928 528 R0
SYMATTR InstName X3
SYMBOL DEADTIME 752 448 R0
SYMATTR InstName X1
SYMBOL res 1392 432 R0
SYMATTR InstName R1
SYMATTR Value 1
SYMBOL IMON 1264 400 M180
SYMATTR InstName X4
SYMBOL POSEDGE 336 480 R0
WINDOW 39 5 58 Bottom 2
SYMATTR SpiceLine TD=1n
SYMATTR InstName X7
SYMBOL CMP 208 480 R0
SYMATTR InstName X9
SYMBOL TYPE2 -80 464 R0
WINDOW 0 -2 -52 Center 2
WINDOW 39 2 58 Center 2
WINDOW 40 2 86 Center 2
SYMATTR InstName X13
SYMATTR SpiceLine g=6 fz1=5k fp1=200k
SYMBOL CONST -368 544 R0
WINDOW 39 0 51 Bottom 2
SYMATTR SpiceLine K={Vout}
SYMATTR InstName X14
SYMBOL fra -256 448 R270
WINDOW 0 16 -32 VTop 2
SYMATTR InstName @1
SYMATTR SpiceLine delay=1m fstart=1k fend=100k oct=2 nmax=2 pp0=2m pp1=2m f0=1k f1=10k tavgmin=100µ tsettle=1m
SYMBOL fraprobe -128 752 R0
SYMATTR InstName &1comp
SYMBOL fraprobe 32 752 R0
SYMATTR InstName &1plant
SYMBOL iNMOS 1056 304 R0
SYMATTR InstName X10
SYMBOL iNMOS 1056 480 R0
SYMATTR InstName X15
SYMBOL PowerSim\\SRFF 480 496 R0
SYMATTR InstName X6
SYMBOL CMP 768 640 M180
WINDOW 39 -7 64 Bottom 2
SYMATTR InstName X8
SYMBOL Digital\\and 480 736 M0
SYMATTR InstName A1
SYMBOL Digital\\inv 384 800 R0
SYMATTR InstName A2
SYMBOL PFD 416 1296 R0
SYMATTR InstName X11
SYMBOL PowerSim\\DFF 192 1184 R0
SYMATTR InstName X12
SYMBOL PowerSim\\PWM -48 1200 R0
WINDOW 39 29 59 Bottom 2
SYMATTR SpiceLine freq={fsw}
SYMATTR InstName X16
SYMBOL CONST -160 1200 R0
WINDOW 39 0 51 Bottom 2
SYMATTR SpiceLine K=0.5
SYMATTR InstName X17
SYMBOL PowerSim\\DFF 192 1408 R0
SYMATTR InstName X18
SYMBOL PowerSim\\CONTACTOR 624 1232 R270
SYMATTR InstName X19
SYMBOL PowerSim\\CONTACTOR 624 1360 R270
SYMATTR InstName X20
SYMBOL cap 816 1360 R0
SYMATTR InstName C2
SYMATTR Value 100p
SYMATTR SpiceLine Rser=1m
SYMBOL current 640 1088 R0
WINDOW 123 0 0 Left 0
WINDOW 39 44 61 Left 2
WINDOW 0 45 1 Left 2
WINDOW 3 41 31 Left 2
SYMATTR SpiceLine load
SYMATTR InstName I1
SYMATTR Value {gm}
SYMBOL current 640 1424 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 108 Left 2
SYMATTR SpiceLine load
SYMATTR InstName I2
SYMATTR Value {gm}
SYMBOL PowerSim\\CONST 528 1072 R0
WINDOW 39 1 55 Bottom 2
SYMATTR SpiceLine K=2Meg
SYMATTR InstName X21
SYMBOL res 912 1312 R0
SYMATTR InstName R2
SYMATTR Value 5k
SYMBOL cap 912 1424 R0
SYMATTR InstName C3
SYMATTR Value 10n
SYMBOL SLOPE 624 624 R0
SYMATTR InstName X5
SYMBOL cap 704 1328 R0
SYMATTR InstName C4
SYMATTR Value 10p
SYMATTR SpiceLine Rser=1k
SYMBOL cap 704 1200 R0
SYMATTR InstName C5
SYMATTR Value 10p
SYMATTR SpiceLine Rser=1k
SYMBOL INVERSE 1152 1296 R0
SYMATTR InstName X22
TEXT 224 128 Left 2 !.tran 2m
TEXT -360 -80 Left 6 ;Adaptive Constant Off-time \nPeak Current Mode Control Buck
TEXT 224 160 Left 2 ;.fra
TEXT 1160 88 Left 2 ;2025-02-23
TEXT -336 112 Left 2 ;Vin=5V, Vout=1V/1A
TEXT 1272 264 Left 2 !.ic I(L1)=0
TEXT 664 1064 Left 2 !.param gm=1
TEXT 1048 1416 Left 2 !.ic V(invToff)=1.2Meg
TEXT 496 1624 Left 4 ;PLL
TEXT -200 1104 Left 2 ;Reference Clock
TEXT -272 216 Left 2 !.param Vin=5\n.param Vout=1\n.param fsw=1Meg
RECTANGLE Normal 1008 1584 112 976 3
